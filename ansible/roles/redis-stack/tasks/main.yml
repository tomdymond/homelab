---
- name: Create stack dir
  file:
    path: /var/stacks/redis-stack
    state: directory
    mode: 0755

- name: Generate docker-compose file
  template:
    src=docker-compose.yml.j2
    dest=/var/stacks/redis-stack/docker-compose.yml

- name: Copy service file for redis-stack
  copy:
    src=redis-stack.service
    dest=/etc/systemd/system/redis-stack.service

- name: Copy service file for redis-stack2
  copy:
    src=redis-stack.service
    dest=/etc/systemd/system/redis-stack2.service

- name: Copy service file for redis-stack3
  copy:
    src=redis-stack.service
    dest=/etc/systemd/system/redis-stack3.service



- name: Restart redis
  systemd:
    state: started
    name: redis-stack
    enabled: yes
    daemon_reload: yes

- name: Restart redis2
  systemd:
    state: started
    name: redis-stack2
    enabled: yes
    daemon_reload: yes

- name: Restart redis3
  systemd:
    state: started
    name: redis-stack2
    enabled: yes
    daemon_reload: yes

